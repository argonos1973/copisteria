<VirtualHost *:5001>
    ServerAdmin webmaster@localhost
    DocumentRoot /var/www/html/frontend

    # Configuración WSGI para la aplicación Flask
    WSGIDaemonProcess myapp python-home=/var/www/html/.venv python-path=/var/www/html
    WSGIProcessGroup myapp
    WSGIScriptAlias /api /var/www/html/app.wsgi

    # Gzip compression
    <IfModule mod_deflate.c>
        AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css application/javascript application/json
    </IfModule>

    # Alias para servir archivos estáticos del backend
    Alias /static /var/www/html/static
    <Directory /var/www/html/static>
        Require all granted
    </Directory>

    # Alias para servir archivos de base de datos
    Alias /db /var/www/html/db
    <Directory /var/www/html/db>
        Options -Indexes
        AllowOverride None
        Require all granted
    </Directory>

    # Permitir acceso directo a los archivos HTML del frontend
    <Directory /var/www/html/frontend>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
        <IfModule mod_headers.c>
            Header always set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
            Header always set Pragma "no-cache"
            Header always set Expires "0"
        </IfModule>
    </Directory>

    # Configuración del directorio raíz
    <Directory /var/www/html>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    <IfModule mod_headers.c>
        Header always set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
        Header always set Pragma "no-cache"
        Header always set Expires "0"
    </IfModule>

    # Logs
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
