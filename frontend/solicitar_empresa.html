<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solicitar Empresa - Aleph70</title>
    <link rel="stylesheet" href="/static/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            background: #f5f5f5;
            padding: 20px;
        }
        .request-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 30px;
            max-width: 800px;
            margin: 0 auto;
        }
        .card-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px 10px 0 0;
            margin: -30px -30px 30px -30px;
            text-align: center;
        }
        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-bottom: 20px;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            padding: 10px 30px;
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        .option-card {
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .option-card:hover {
            border-color: #667eea;
            background: #f8f9fa;
        }
        .option-card i {
            font-size: 40px;
            color: #667eea;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="request-card">
        <div class="card-header">
            <h3><i class="fas fa-building"></i> Solicitar Acceso a Empresa</h3>
        </div>

        <div id="alertContainer"></div>

        <div class="info-box">
            <h5><i class="fas fa-info-circle"></i> Tu cuenta actual</h5>
            <p>Actualmente no tienes una empresa asignada. Esto limita tu acceso solo al menú de Gestión.</p>
            <p class="mb-0">Para acceder a todas las funcionalidades del sistema, necesitas estar asociado a una empresa.</p>
        </div>

        <h4>Opciones disponibles:</h4>
        
        <div class="options-grid">
            <div class="option-card" onclick="mostrarFormularioSolicitud()">
                <i class="fas fa-paper-plane"></i>
                <h5>Solicitar Acceso</h5>
                <p>Solicita acceso a una empresa existente</p>
            </div>
            
            <div class="option-card" onclick="mostrarFormularioNueva()">
                <i class="fas fa-plus-circle"></i>
                <h5>Nueva Empresa</h5>
                <p>Solicita la creación de una nueva empresa</p>
            </div>
        </div>

        <!-- Formulario de solicitud (oculto inicialmente) -->
        <div id="formularioSolicitud" style="display:none; margin-top:30px;">
            <hr>
            <h4>Solicitar Acceso a Empresa Existente</h4>
            <form id="requestAccessForm">
                <div class="form-group">
                    <label><i class="fas fa-building"></i> Código de Empresa</label>
                    <input type="text" class="form-control" id="codigoEmpresa" required 
                           placeholder="Ingresa el código de la empresa">
                    <small class="text-muted">Solicita este código al administrador de tu empresa</small>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-comment"></i> Mensaje (opcional)</label>
                    <textarea class="form-control" id="mensaje" rows="3" 
                              placeholder="Explica por qué necesitas acceso a esta empresa"></textarea>
                </div>
                
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-paper-plane"></i> Enviar Solicitud
                </button>
                <button type="button" class="btn btn-secondary" onclick="ocultarFormularios()">
                    <i class="fas fa-times"></i> Cancelar
                </button>
            </form>
        </div>

        <!-- Formulario nueva empresa (oculto inicialmente) -->
        <div id="formularioNueva" style="display:none; margin-top:30px;">
            <hr>
            <h4>Solicitar Nueva Empresa</h4>
            <form id="newCompanyForm">
                <div class="form-group">
                    <label><i class="fas fa-building"></i> Nombre de la Empresa</label>
                    <input type="text" class="form-control" id="nombreEmpresa" required>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-phone"></i> Teléfono de Contacto</label>
                    <input type="tel" class="form-control" id="telefono" required>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-envelope"></i> Email Corporativo</label>
                    <input type="email" class="form-control" id="emailCorporativo" required>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-comment"></i> Descripción del Negocio</label>
                    <textarea class="form-control" id="descripcion" rows="3" required 
                              placeholder="Describe brevemente tu negocio y por qué necesitas el sistema"></textarea>
                </div>
                
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-paper-plane"></i> Enviar Solicitud
                </button>
                <button type="button" class="btn btn-secondary" onclick="ocultarFormularios()">
                    <i class="fas fa-times"></i> Cancelar
                </button>
            </form>
        </div>
    </div>

    <script>
        function mostrarFormularioSolicitud() {
            document.getElementById('formularioSolicitud').style.display = 'block';
            document.getElementById('formularioNueva').style.display = 'none';
        }
        
        function mostrarFormularioNueva() {
            document.getElementById('formularioNueva').style.display = 'block';
            document.getElementById('formularioSolicitud').style.display = 'none';
        }
        
        function ocultarFormularios() {
            document.getElementById('formularioSolicitud').style.display = 'none';
            document.getElementById('formularioNueva').style.display = 'none';
        }
        
        // Formulario acceso empresa existente
        document.getElementById('requestAccessForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const data = {
                codigo_empresa: document.getElementById('codigoEmpresa').value,
                mensaje: document.getElementById('mensaje').value
            };
            
            try {
                // Por ahora solo mostramos mensaje de éxito
                mostrarAlerta('Solicitud enviada. El administrador revisará tu petición.', 'success');
                document.getElementById('requestAccessForm').reset();
                ocultarFormularios();
            } catch (error) {
                mostrarAlerta('Error al enviar la solicitud', 'danger');
            }
        });
        
        // Formulario nueva empresa
        document.getElementById('newCompanyForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const data = {
                nombre: document.getElementById('nombreEmpresa').value,
                telefono: document.getElementById('telefono').value,
                email: document.getElementById('emailCorporativo').value,
                descripcion: document.getElementById('descripcion').value
            };
            
            try {
                // Por ahora solo mostramos mensaje de éxito
                mostrarAlerta('Solicitud enviada. Nos pondremos en contacto pronto.', 'success');
                document.getElementById('newCompanyForm').reset();
                ocultarFormularios();
            } catch (error) {
                mostrarAlerta('Error al enviar la solicitud', 'danger');
            }
        });
        
        function mostrarAlerta(mensaje, tipo) {
            const container = document.getElementById('alertContainer');
            container.innerHTML = `
                <div class="alert alert-${tipo} alert-dismissible fade show">
                    ${mensaje}
                    <button type="button" class="close" data-dismiss="alert">
                        <span>&times;</span>
                    </button>
                </div>
            `;
            
            setTimeout(() => {
                container.innerHTML = '';
            }, 5000);
        }
    </script>
</body>
</html>
